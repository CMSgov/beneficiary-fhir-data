---
##
# Configures the LSS zone's build server (e.g. Jenkins).
##

- name: Configure Build Server
  hosts: builds

  # Needs to be specified here, as it's not configured properly on the host
  # itself.
  environment:
    no_proxy: localhost
    http_proxy: "http://{{ vault_proxy_host }}:{{ vault_proxy_port }}"
    https_proxy: "http://{{ vault_proxy_host }}:{{ vault_proxy_port }}"

  tasks:

    - name: Install and Configure Apache
      import_role:
        name: builds_apache

    - name: Install and Configure Jenkins
      import_role:
        name: builds_jenkins

