<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="966px" preserveAspectRatio="none" style="width:512px;height:966px;background:#FFFFFF;" version="1.1" viewBox="0 0 512 966" width="512px" zoomAndPan="magnify"><defs><filter height="300%" id="f1293vfrcw2b97" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="395" x="56.5" y="29.4023">2022-02 Deployment Sequence (Abbreviated)</text><rect fill="#FFFFFF" filter="url(#f1293vfrcw2b97)" height="676.7637" style="stroke:#000000;stroke-width:2.0;" width="423" x="75" y="202.3086"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="41" x2="41" y1="102.6875" y2="896.0723"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="137" x2="137" y1="102.6875" y2="896.0723"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="274.5" x2="274.5" y1="102.6875" y2="896.0723"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="458.5" x2="458.5" y1="102.6875" y2="896.0723"/><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="63" x="8" y="67.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="15" y="87.7344">Jenkins</text><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="63" x="8" y="895.0723"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="15" y="915.6074">Jenkins</text><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="100" x="85" y="67.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="92" y="87.7344">bfd-pipeline</text><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="100" x="85" y="895.0723"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="92" y="915.6074">bfd-pipeline</text><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="229.5" y="67.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="236.5" y="87.7344">bfd-server</text><rect fill="#FEFECE" filter="url(#f1293vfrcw2b97)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="229.5" y="895.0723"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="236.5" y="915.6074">bfd-server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="440.5" y="99.7344">FHIR</text><path d="M441,50.1992 C441,40.1992 459,40.1992 459,40.1992 C459,40.1992 477,40.1992 477,50.1992 L477,76.1992 C477,86.1992 459,86.1992 459,86.1992 C459,86.1992 441,86.1992 441,76.1992 L441,50.1992 " fill="#FEFECE" filter="url(#f1293vfrcw2b97)" style="stroke:#000000;stroke-width:1.5;"/><path d="M441,50.1992 C441,60.1992 459,60.1992 459,60.1992 C459,60.1992 477,60.1992 477,50.1992 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="440.5" y="908.6074">FHIR</text><path d="M441,921.5605 C441,911.5605 459,911.5605 459,911.5605 C459,911.5605 477,911.5605 477,921.5605 L477,947.5605 C477,957.5605 459,957.5605 459,957.5605 C459,957.5605 441,957.5605 441,947.5605 L441,921.5605 " fill="#FEFECE" filter="url(#f1293vfrcw2b97)" style="stroke:#000000;stroke-width:1.5;"/><path d="M441,921.5605 C441,931.5605 459,931.5605 459,931.5605 C459,931.5605 477,931.5605 477,921.5605 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><path d="M5,117.6875 L5,142.6875 L312,142.6875 L312,127.6875 L302,117.6875 L5,117.6875 " fill="#FBFB77" filter="url(#f1293vfrcw2b97)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M302,117.6875 L302,127.6875 L312,127.6875 L302,117.6875 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="39.75" y="135.2559">Deployment stage is largely parallel</text><polygon fill="#A80036" points="125,169.3086,135,173.3086,125,177.3086,129,173.3086" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="41.5" x2="131" y1="173.3086" y2="173.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="48.5" y="168.5664">Deploy</text><polygon fill="#A80036" points="263,183.3086,273,187.3086,263,191.3086,267,187.3086" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="41.5" x2="269" y1="187.3086" y2="187.3086"/><path d="M75,202.3086 L202,202.3086 L202,209.3086 L192,219.3086 L75,219.3086 L75,202.3086 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="676.7637" style="stroke:#000000;stroke-width:2.0;" width="423" x="75" y="202.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="90" y="215.877">Deployment</text><path d="M280,224.6191 L280,264.6191 L477,264.6191 L477,234.6191 L467,224.6191 L280,224.6191 " fill="#FBFB77" filter="url(#f1293vfrcw2b97)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M467,224.6191 L467,234.6191 L477,234.6191 L467,224.6191 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="286" y="242.1875">Update launch template,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="286" y="257.498">re-create autoscaling group</text><line style="stroke:#A80036;stroke-width:1.0;" x1="275" x2="317" y1="310.8613" y2="310.8613"/><line style="stroke:#A80036;stroke-width:1.0;" x1="317" x2="317" y1="310.8613" y2="323.8613"/><line style="stroke:#A80036;stroke-width:1.0;" x1="276" x2="317" y1="323.8613" y2="323.8613"/><polygon fill="#A80036" points="286,319.8613,276,323.8613,286,327.8613,282,323.8613" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="282" y="290.8086">Bootstrap,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="282" y="306.1191">Validate</text><polygon fill="#A80036" points="447,349.1719,457,353.1719,447,357.1719,451,353.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="275" x2="453" y1="353.1719" y2="353.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="282" y="348.4297">Hibernate Validations</text><polygon fill="#A80036" points="286,378.4824,276,382.4824,286,386.4824,282,382.4824" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="280" x2="458" y1="382.4824" y2="382.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="292" y="377.7402">Valid</text><line style="stroke:#A80036;stroke-width:1.0;" x1="275" x2="317" y1="411.793" y2="411.793"/><line style="stroke:#A80036;stroke-width:1.0;" x1="317" x2="317" y1="411.793" y2="424.793"/><line style="stroke:#A80036;stroke-width:1.0;" x1="276" x2="317" y1="424.793" y2="424.793"/><polygon fill="#A80036" points="286,420.793,276,424.793,286,428.793,282,424.793" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="282" y="407.0508">Serve HTTP Requests</text><polygon fill="#A80036" points="286,450.1035,276,454.1035,286,458.1035,282,454.1035" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="447,450.1035,457,454.1035,447,458.1035,451,454.1035" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="280" x2="453" y1="454.1035" y2="454.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="292" y="449.3613">Continued Read Requests</text><path d="M245,467.1035 L245,538.1035 L488,538.1035 L488,477.1035 L478,467.1035 L245,467.1035 " fill="#FBFB77" filter="url(#f1293vfrcw2b97)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M478,467.1035 L478,477.1035 L488,477.1035 L478,467.1035 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="279.5" y="484.6719">!!! DB requests</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="279.5" y="499.9824">can begin before</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="279.5" y="515.293">bfd-pipeline's migrations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="279.5" y="530.6035">complete</text><path d="M142,552.3457 L142,607.3457 L247,607.3457 L247,562.3457 L237,552.3457 L142,552.3457 " fill="#FBFB77" filter="url(#f1293vfrcw2b97)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M237,552.3457 L237,562.3457 L247,562.3457 L237,552.3457 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="148" y="569.9141">Recreate ec2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="148" y="585.2246">instance with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="148" y="600.5352">new AMI</text><line style="stroke:#A80036;stroke-width:1.0;" x1="137" x2="179" y1="669.209" y2="669.209"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="179" y1="669.209" y2="682.209"/><line style="stroke:#A80036;stroke-width:1.0;" x1="138" x2="179" y1="682.209" y2="682.209"/><polygon fill="#A80036" points="148,678.209,138,682.209,148,686.209,144,682.209" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="144" y="633.8457">Bootstrap,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="144" y="649.1563">Migrate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="144" y="664.4668">Validate</text><polygon fill="#A80036" points="447,707.5195,457,711.5195,447,715.5195,451,711.5195" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="137" x2="453" y1="711.5195" y2="711.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="144" y="706.7773">Execute Migrations</text><polygon fill="#A80036" points="148,736.8301,138,740.8301,148,744.8301,144,740.8301" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142" x2="458" y1="740.8301" y2="740.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="154" y="736.0879">Changes committed</text><polygon fill="#A80036" points="447,766.1406,457,770.1406,447,774.1406,451,770.1406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="137" x2="453" y1="770.1406" y2="770.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="144" y="765.3984">Hibernate Validations</text><polygon fill="#A80036" points="148,795.4512,138,799.4512,148,803.4512,144,799.4512" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142" x2="458" y1="799.4512" y2="799.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="154" y="794.709">Valid</text><line style="stroke:#A80036;stroke-width:1.0;" x1="137" x2="179" y1="828.7617" y2="828.7617"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="179" y1="828.7617" y2="841.7617"/><line style="stroke:#A80036;stroke-width:1.0;" x1="138" x2="179" y1="841.7617" y2="841.7617"/><polygon fill="#A80036" points="148,837.7617,138,841.7617,148,845.7617,144,841.7617" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="144" y="824.0195">Run "bfd-pipelines"</text><polygon fill="#A80036" points="148,867.0723,138,871.0723,148,875.0723,144,871.0723" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="447,867.0723,457,871.0723,447,875.0723,451,871.0723" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="142" x2="453" y1="871.0723" y2="871.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="154" y="866.3301">Continued Database Interactions</text><!--MD5=[5a662da9c4719bc5b62961486b8bfcc4]
@startuml
title 2022-02 Deployment Sequence (Abbreviated)
participant Jenkins
participant "bfd-pipeline"
participant "bfd-server"
database FHIR
note over Jenkins,"bfd-server": Deployment stage is largely parallel
Jenkins -> "bfd-pipeline": Deploy
Jenkins -> "bfd-server":
group Deployment
       note right of "bfd-server": Update launch template,\nre-create autoscaling group
       "bfd-server" -> "bfd-server": Bootstrap,\nValidate
       "bfd-server" -> FHIR: Hibernate Validations
       FHIR - -> "bfd-server": Valid
       "bfd-server" -> "bfd-server": Serve HTTP Requests
       "bfd-server" <-> FHIR: Continued Read Requests
       note over "bfd-server",FHIR: !!! DB requests\ncan begin before\nbfd-pipeline's migrations\ncomplete
       note right of "bfd-pipeline": Recreate ec2\ninstance with\nnew AMI
       "bfd-pipeline" -> "bfd-pipeline": Bootstrap,\nMigrate,\nValidate
       "bfd-pipeline" -> FHIR: Execute Migrations
       FHIR - -> "bfd-pipeline": Changes committed
       "bfd-pipeline" -> FHIR: Hibernate Validations
       FHIR - -> "bfd-pipeline": Valid
       "bfd-pipeline" -> "bfd-pipeline": Run "bfd-pipelines"
       "bfd-pipeline" <-> FHIR: Continued Database Interactions
end
@enduml

PlantUML version 1.2022.1(Tue Feb 01 12:19:58 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>