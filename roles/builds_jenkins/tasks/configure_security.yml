---
##
# Configures Jenkins' security: authentication and authorization.
##

# Configure security to use Jenkins-local accounts.
- name: Configure Security
  jenkins_script:
    url: "{{ jenkins_url_local }}"
    user: "{{ jenkins_dynamic_admin_username | default(omit) }}"
    password: "{{ jenkins_dynamic_admin_password | default(omit) }}"
    script: "{{ lookup('template', 'templates/configure_security.groovy.j2') }}"
  register: jenkins_script_security
  changed_when: "(jenkins_script_security | success) and 'Changed' in jenkins_script_security.output"
