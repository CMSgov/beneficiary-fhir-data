#ansible-playbook rotate_bfd_postgres_user.yml --extra-vars "rds_database= master_user= master_pw= old_user= db_user= db_user_pw= rds_region="
- hosts: localhost
  vars:
    rds_database: 
    master_user: 
    master_pw: 
    db_user:
    db_user_pw:
    rds_region:

  tasks:
    - name: RDS Gather Facts/Info
#      rds_instance_info: #requires Ansible 2.9+
      rds_instance_facts:
        db_instance_identifier: "{{ rds_database }}"

      register: database_info

    - name: Create RDS PostgreSQL Database
      postgresql_user:
        login_host: "{{ database_info.instances[0].endpoint.address }}"
        login_user: "{{ database_info.instances[0].master_username }}"
        login_password: "{{ master_pw }}"
        db: postgres
        name: "{{ db_user }}"
        state: present